<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="utf-8">
<title>Mapbox GL JS map</title>
<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
<link href="https://api.mapbox.com/mapbox-gl-js/v3.6.0/mapbox-gl.css" rel="stylesheet"> 
<script src="https://api.mapbox.com/mapbox-gl-js/v3.6.0/mapbox-gl.js"></script>
<!-- Add JQuery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<style>
body { margin: 0; padding: 0; }
#map { position: absolute; top: 0; bottom: 0; width: 100%; }
</style>
</head>

<body>
    <style>
        .map-overlay-container {  
            position: absolute;
            width: 97%;
            height:auto;
            margin: auto;
            top: 0;
            left: 0;
            padding: 5px;
            z-index: 1;
        }
    
        .map-overlay {
            font:
                'Tahoma',
                sans-serif;
            background-color: #e8ffea;
            border-color: cornsilk;
            border-radius: 3px;
            padding: 10px;
            box-shadow: 0 2px 3px rgba(0, 0, 0, 0.3);
        }
    
        .map-overlay h2 {
            text-align: center;
            font-size: 20px;
            color: #0d4a24;
        }

        .map-overlay p {
            text-align: center;
            font-size: 16px;
            margin: 0 0 0.5em;
            color: #0d4a24;
        }

        .map-overlay img {
            max-height: 100px; /* Make the image fit in the map overlay container */
            border: 4px ridge #083218;
            border-radius: 1em; /*Round the corners of the image*/
        }

        /* Mobile first styling */
        @media only screen and (min-width: 600px) {
            .map-overlay-container {width: 98%;}
            .map-overlay h2 {font-size: 30px;}
            .map-overlay p {
                font-size: 18px;
                margin: 0 0 0.6em;
            }
            .map-overlay img {max-height: 250px;}
        }

        @media only screen and (min-width: 850px) {
            .map-overlay-container {
                position:absolute;
                width: 33%;
                padding: 10px;}
            .map-overlay h2 {font-size: 36px;}
            .map-overlay p {
                font-size: 24px;
                margin: 0 0 0.6em;
            }
            .map-overlay img {max-height: 300px;}
        }
    </style>

<div id="map"></div>

<div class="map-overlay-container">
    <div class="map-overlay"> <!--The titles, descriptions, and image sources are defined for their respective locations below-->
        <h2 id="location-title"></h2>
        <p id="location-description"></p>
        <img id="location-photo"></img>
    </div>
</div>

<script>
	mapboxgl.accessToken = 'pk.eyJ1IjoiY2phcmNodWxldGExMnV3bSIsImEiOiJjbTFiNXhwenYxbDluMmpvaW5tNWpyaDI1In0.tZ-qZeLZ34HEOdzbLIh4Kw';
    const map = new mapboxgl.Map({
        container: 'map', // container ID
        style: 'mapbox://styles/cjarchuleta12uwm/clzbm0i23002r01qp2u2k48c3', // style URL
        center: [-110, 40], // starting position [lng, lat]. Note that lat must be set between -90 and 90
        zoom: 3.4 // starting zoom
    })  

    const title = document.getElementById('location-title'); //From the pop-up/slide/map overlay
    const description = document.getElementById('location-description');
    const photo = document.getElementById('location-photo');

    // Images constant is list of images for the map overlay
    const images = ['Assets/Chris_Tenney.JPG','Assets/Chris_Kegonsa.jpg','Assets/Chris_Tenney.JPG']

    const locations = [
        {
            'title': 'HAPPY ANNIVERSARY, OLIVIA!',
            'description':
                'It ain`t much, but it`s honest work. I love you so much and I cherish all of our memories!',
            'camera': {
                center: [-110, 40],
                zoom: 3.4,
                bearing: 0,
                pitch: 0
            }
        },
        {
            'id': 'Milwaukee Brat House',
            'title': 'Milwaukee Brat House',
            'description':
                "Our very first date! 08/26/2022",
            'camera': {
                center: [-87.8874, 43.0897],
                zoom: 19,
                pitch: 20 // Up-down angle, with 0 being straight down and 85 being toward the horizon
            }
        },
        {
            'id': 'Home',
            'title': 'Home',
            'description':
                "You, me, cats, plants, food, TV, games, dancing, and bed.",
            'camera': {
                center: [-87.8870, 43.089],
                bearing: -8.9, //Compass, 0 is north
                zoom: 16
            }
        },
        {
            'id': 'UWM',
            'title': 'UWM',
            'description':
                "The hell that brought us together.",
            'camera': {
                center: [-87.8810, 43.0769],
                bearing: 0,
                zoom: 15
            }
        },
        {
            'id': 'Bradford Beach',
            'title': 'Bradford Beach',
            'description':
                'We had Twisted Teas and I got sunburnt.',
            'camera': {
                center: [-87.8770, 43.0598],
                bearing: 15,
                zoom: 14.5
            }
        },
        {
            'id': 'Cheba Hut',
            'title': 'Cheba Hut',
            'description':
                'The subs are so goooood! I would get blissful after just a couple sips, and you always looked phenomenal!',
            'camera': {
                center: [-87.8883, 43.0713],
                bearing: 0,
                zoom: 18
            }
        },
        {
            'id': 'Knuckleheads',
            'title': 'Knuckleheads',
            'description':
                'This was THE PLACE when we started getting high together.',
            'camera': {
                center: [-87.8883, 43.07215],
                bearing: 0,
                zoom: 16
            }
        }
    ];

    function highlightSpot(code) {
        // Only label the point feature that corresponds to `Name` in the data.
        map.setFilter('omj-map-coordinates-sheet1-6bm15c copy', ['==', 'Name', code]);
    }

    function setImage(index) {
        photo.src = images[index] //Image for a specific location is based on the images list position, which corresponds to the locations list.
    }

    function playback(index) {

        title.textContent = locations[index].title; //The title for a specific location is based on the locations list position
        description.textContent = locations[index].description;
        setImage(index); //Passing the index into the setImage function synchronizes the locations with the images

        //Argument for highlightSpot, which is the "code" parameter, is determined by locations list position.
        highlightSpot(locations[index].id ? locations[index].id : '');

        // Animate the map position based on camera properties.
        map.flyTo(locations[index].camera);

        map.once('movestart', () => {
            $(document).ready(function(){
            $("#location-title").fadeIn(2000);
            $("#location-description").fadeIn(2000);
            $("#location-photo").fadeIn(2000);
            });
        });

        map.once('moveend', () => {
            // Duration the slide is on screen after interaction.
            window.setTimeout(() => {
                // Increment index, looping back to the first after the last location.
                index = (index + 1) % locations.length;
                playback(index);
            }, 8000); // After callback, show the location for 20 seconds.

            //Fade Out inside map.once Moveend to time according to map transition (otherwise fade out won't synchronize)
            $(document).ready(function(){
            $("#location-title").stop(false, true).delay(5000).fadeOut(3000);
            $("#location-description").stop(false, true).delay(5000).fadeOut(3000);
            $("#location-photo").stop(false, true).delay(5000).fadeOut(3000);
            });
        });
    }

    map.on('load', () => {
        // Start the playback animation for each location.
        playback(0);
    });
</script>

</body>
</html>